# [000883] Broken Loop in getUnclaimedAmounts()
  
  ### Summary

In the getUnclaimedAmounts() function, the loop fails to increment the index i inside the continue branch.
This causes an infinite loop whenever claimedFlows[i] == true, resulting in: function never completing, contract freezing during execution, gas exhaustion and guaranteed revert.

### Root Cause

https://github.com/dualguard/2025-11-alignerz/blob/main/protocol/src/contracts/A26ZDividendDistributor/A26ZDividendDistributor.sol#L140

```sol
function getUnclaimedAmounts(uint256 nftId) public returns (uint256 amount) {
        if (address(token) == address(vesting.allocationOf(nftId).token)) return 0;
        uint256[] memory amounts = vesting.allocationOf(nftId).amounts;
        uint256[] memory claimedSeconds = vesting.allocationOf(nftId).claimedSeconds;
        uint256[] memory vestingPeriods = vesting.allocationOf(nftId).vestingPeriods;
        bool[] memory claimedFlows = vesting.allocationOf(nftId).claimedFlows;
        uint256 len = vesting.allocationOf(nftId).amounts.length;
        for (uint256 i; i < len;) {
 @>           if (claimedFlows[i]) continue;
            if (claimedSeconds[i] == 0) {
                amount += amounts[i];
                continue;
            }
            uint256 claimedAmount = claimedSeconds[i] * amounts[i] / vestingPeriods[i];
            uint256 unclaimedAmount = amounts[i] - claimedAmount;
            amount += unclaimedAmount;
            unchecked {
                ++i;
            }
        }
        unclaimedAmountsIn[nftId] = amount;
    }
```

When claimedFlows[i] == true, the continue statement executes without incrementing i, causing the loop to remain stuck at the same index forever.

Affected Functions

getUnclaimedAmounts() (direct)

getTotalUnclaimedAmounts() (indirect)

_setAmounts() → relies on the above

_setDividends() → relies on outputs of the above

This cascades and breaks the entire dividend distribution mechanism.

### Internal Pre-conditions

None

### External Pre-conditions

None

### Attack Path

None

### Impact

Any call to getUnclaimedAmounts() will revert if it encounters a claimed flow.



### PoC

None

### Mitigation

_No response_
  