# [000387] Missing loop increment in calculateFeeAndNewAmountForOneTVS leads to permanent Denial of Service (DoS)
  
  ### Summary

A missing increment statement in the for loop of `calculateFeeAndNewAmountForOneTVS` will cause a Denial of Service (DoS) for users attempting to merge or split TVS as the transaction will enter an infinite loop and revert due to running out of gas.

### Root Cause

In `FeesManager.sol` the `for` loop in `calculateFeeAndNewAmountForOneTVS` fails to increment the loop counter `i`.
```
for (uint256 i; i < length;) {
    // ... logic ...
    // Missing: ++i;
}
```
Because `i` remains `0` indefinitely, the condition `i < length` (assuming `length > 0`) remains permanently `true`, causing an infinite loop.

### Internal Pre-conditions

1. User attempts to interact with any function that utilizes the fee calculation logic (mergeTVS or splitTVS).
3. The input array amounts must have a length of at least `1`.

### External Pre-conditions

_No response_

### Attack Path

1. User calls `mergeTVS `(or `splitTVS`) with valid parameters.
2. The `AlignerzVesting` contract calls `FeesManager.calculateFeeAndNewAmountForOneTVS`.
3. The function enters the for loop with `i = 0`.
4. The logic inside the loop executes for index `0`.
5. The loop reaches the end of the block. Since there is no increment `(i++)`, `i` remains `0`.
6. The loop condition `0 < length` checks `true`.
7. Steps 4-6 repeat infinitely until the transaction consumes the entire block gas limit.
8. The transaction reverts with an Out of Gas error.

### Impact

The users cannot execute `mergeTVS `or `splitTVS` operations. These core protocol features are functionally broken (bricked) for any real-world usage involving token amounts.

### PoC

_No response_

### Mitigation

Add the increment logic for the loop counter `i`.
```
function calculateFeeAndNewAmountForOneTVS(uint256 feeRate, uint256[] memory amounts, uint256 length) public pure returns (uint256 feeAmount, uint256[] memory newAmounts) {
        for (uint256 i; i < length;) {
            // ... calculation logic ...
            
+            unchecked { ++i; } // Fix : Increment loop
        }
    }
```
  