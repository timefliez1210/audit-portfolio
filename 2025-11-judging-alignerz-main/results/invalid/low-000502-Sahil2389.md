# [000502] Missing `onlyOwner` Modifier Allows Anyone to Distribute KOL Rewards After Deadline
  
  ### Summary

The `distributeRewardTVS()` and `distributeStablecoinAllocation()` functions are documented as owner-only but lack the `onlyOwner` modifier, allowing anyone to call them after the deadline passes. While this doesn't cause direct fund loss (rewards go to intended KOLs), it creates griefing opportunities and violates access control principles.


### Root Cause


In `AlignerzVesting.sol` contract in `distributeRewardTVS()` and ` distributeStablecoinAllocation()` function Missing Access Control Modifier Despite Documentation/Commentsection describes only owner can call it :

```solidity
/// @notice Allows the owner to distribute the TVS that have not been claimed yet to the KOLs
/// @param rewardProjectId Id of the rewardProject
/// @param kol addresses of the KOLs who chose to be rewarded in stablecoin that have not claimed their tokens during the claimWindow
function distributeRewardTVS(uint256 rewardProjectId, address[] calldata kol) external {
@>  //  Missing: onlyOwner modifier
    // Documentation says "Allows the owner" but anyone can call
    RewardProject storage rewardProject = rewardProjects[rewardProjectId];
    require(block.timestamp > rewardProject.claimDeadline, Deadline_Has_Not_Passed());
    uint256 len = rewardProject.kolTVSAddresses.length;
    for (uint256 i; i < len;) {
        _claimRewardTVS(rewardProjectId, kol[i]);
        unchecked {
            ++i;
        }
    }
}

/// @notice Allows the owner to distribute the stablecoin tokens that have not been claimed yet to the KOLs
function distributeStablecoinAllocation(uint256 rewardProjectId, address[] calldata kol) external {
@>  //  Missing: onlyOwner modifier
    RewardProject storage rewardProject = rewardProjects[rewardProjectId];
    require(block.timestamp > rewardProject.claimDeadline, Deadline_Has_Not_Passed());
    uint256 len = rewardProject.kolStablecoinAddresses.length;
    for (uint256 i; i < len;) {
        _claimStablecoinAllocation(rewardProjectId, kol[i]);
        unchecked {
            ++i;
        }
    }
}
```

Comparison with Similar Functions that DO have modifier:
```solidity
/// @notice Allows the owner to distribute the TVS that have not been claimed yet to the KOLs
function distributeRemainingRewardTVS(uint256 rewardProjectId) external onlyOwner {
@>    //  HAS onlyOwner modifier
    // ...
}

/// @notice Allows the owner to distribute the Stablecoin tokens that have not been claimed yet to the KOLs
function distributeRemainingStablecoinAllocation(uint256 rewardProjectId) external onlyOwner {
@>    //  HAS onlyOwner modifier
    // ...
}
```

Code Snippet-
https://github.com/dualguard/2025-11-alignerz/blob/f7eeed88d91356484c02af6f38b71f27b790828c/protocol/src/contracts/vesting/AlignerzVesting.sol#L525-L550


### Internal Pre-conditions

1. Claim deadline has passed: `block.timestamp > claimDeadline`.
2. KOLs have unclaimed TVS or stablecoin allocations.
3. `kolTVSAddresses` or `kolStablecoinAddresses` arrays are not empty.


### External Pre-conditions

N/A

### Attack Path

Scenario : Griefing Attack - Force Distribution Before Owner Ready (though not profitable for attacker)

```solidity
// 1. Deadline passes
// block.timestamp > claimDeadline

// 2. Owner plans to distribute manually after additional coordination with KOLs
// But attacker front-runs and distributes first

// 3. Attacker calls distribution
address[] memory kols = new address[](5);
kols[0] = kolAddress1;
kols[1] = kolAddress2;
// ... etc

// Anyone can call (no onlyOwner check)
vesting.distributeRewardTVS(projectId, kols);

// 4. NFTs minted and sent to KOLs immediately
// Owner loses control over distribution timing
```

### Impact

Owner can't control when distribution occurs. Documentation says "Allows the owner" but anyone can call this function . Missing access control according commen/documents.


### PoC

N/A

### Mitigation

N/A
  