# [000650] EndTime Storage Exposure - Gaming Prevention Mechanism Bypassed
  
  ### Summary

Sophisticated bidders will gain unfair timing advantage as the protocol exposes the plaintext bidding end time in storage despite using a hash-based secrecy mechanism.

### Root Cause

In `AlignerzVesting.sol:launchBiddingProject()` ([lines ~631â€“650](https://github.com/dualguard/2025-11-alignerz/blob/f7eeed88d91356484c02af6f38b71f27b790828c/protocol/src/contracts/vesting/AlignerzVesting.sol#L667C3-L667C40)), the contract stores both the hashed `endTimeHash` and the plaintext `endTime` in the `BiddingProject` struct, allowing direct storage inspection to bypass the intended secrecy.

### Internal Pre-conditions

1. Owner needs to call `launchBiddingProject()` with a hash and plaintext endTime

### External Pre-conditions

1. Attacker must be able to read contract storage (trivial on any public blockchain)

### Attack Path

1. Owner launches bidding project with secret end time (hashed)
2. Attacker uses `eth_getStorageAt()` RPC call to inspect contract storage slots
3. Attacker extracts the plaintext `endTime` directly from storage
4. Attacker times their bid to hit the exact deadline, gaining advantage over uninformed bidders

### Impact

The bidders lose fair bidding opportunity as attackers gain precise timing advantage. The protocol suffers undermined auction mechanics and reduced trust in fairness.

### PoC

```javascript

const storageSlot = web3.utils.keccak256('0x...');

const endTime = await ethers.provider.getStorageAt(contractAddress, storageSlot);

console.log("Secret end time revealed:", endTime);
```

### Mitigation

```solidity

// Only store hash: biddingProject.endTimeHash = endTimeHash

// Remove: biddingProject.endTime = endTime;


// In finalizeBids, add endTime as parameter and verify:

function finalizeBids(```solidity

    uint256 projectId, 

    uint256 endTime,**External Pre-conditions**:function distributeRewardTVS(uint256 rewardProjectId, address[] calldata kol) external {

    bytes32 refundRoot, 

    bytes32[] calldata merkleRoots, 
    uint256 claimWindow

) external onlyOwner {    require(block.timestamp > rewardProject.claimDeadline, Deadline_Has_Not_Passed());

    BiddingProject storage biddingProject = biddingProjects[projectId];

    require(keccak256(abi.encodePacked(endTime)) == biddingProject.endTimeHash, "Invalid_EndTime")

    biddingProject.endTime = endTime;

}

```
  