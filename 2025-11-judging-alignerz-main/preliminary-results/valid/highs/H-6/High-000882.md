# [000882] Unbounded Loop in getTotalUnclaimedAmounts() and _setDividends() May Cause Out-of-Gas Failures
  
  ### Summary

The functions getTotalUnclaimedAmounts() and _setDividends() perform linear iteration over the entire NFT supply through:

```sol
uint256 len = nft.getTotalMinted();
for (uint256 i; i < len; ) { ... }

```

If the protocol mints a large number of NFTs, the loop may become too long to execute within the block gas limit. Both functions perform relatively expensive operations inside the loop, increasing the risk of hitting the gas ceiling.

Since these functions involve important accounting logic (unclaimed rewards and dividend distribution), failing due to out-of-gas can break core protocol functionality.

### Root Cause

https://github.com/dualguard/2025-11-alignerz/blob/main/protocol/src/contracts/A26ZDividendDistributor/A26ZDividendDistributor.sol#L127

```sol

    function getTotalUnclaimedAmounts() public returns (uint256 _totalUnclaimedAmounts) {
        uint256 len = nft.getTotalMinted();
        for (uint256 i; i < len;) {
            (, bool isOwned) = safeOwnerOf(i);
            if (isOwned) _totalUnclaimedAmounts += getUnclaimedAmounts(i);
            unchecked {
                ++i;
            }
        }
    }

```

Both functions loop from 0 to nft.getTotalMinted(). If the number of minted NFTs is large (hundreds, thousands, or more), the loop becomes extremely gas-heavy.

Once gas usage exceeds block limits, the protocol becomes unable to compute or distribute dividends, effectively locking all vesting reward distribution.

### Internal Pre-conditions

None

### External Pre-conditions

None

### Attack Path

None

### Impact

If the number of NFTs grows large enough, getTotalUnclaimedAmounts() _setDividends() and  will always revert due to out-of-gas.

### PoC

None

### Mitigation

_No response_
  