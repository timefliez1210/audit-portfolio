# [000116]  An uninitialized memory array in FeesManager.sol will cause a denial of service for users attempting to split or merge TVSs
  
  ### Summary

An uninitialized memory array in FeesManager.sol will cause a permanent denial of service for users attempting to split or merge TVSs as the contract attempts to write to a null memory pointer.

### Root Cause

In src/contracts/vesting/feesManager/FeesManager.sol, inside the function calculateFeeAndNewAmountForOneTVS, the return variable uint256[] memory newAmounts is declared but memory is never allocated for it (e.g., new uint256[](length) is missing).

### Internal Pre-conditions

Users must attempt to use splitTVS or mergeTVS functionality.

### External Pre-conditions

None.

### Attack Path

User calls splitTVS in AlignerzVesting.sol.
Vesting contract calls FeesManager.calculateFeeAndNewAmountForOneTVS.
The function attempts to write to newAmounts[i].
The EVM panics due to memory access out of bounds.

### Impact

The "Liquidity Revolution" features (splitting and merging) are completely broken. Users cannot manage their TVS positions as intended.


### PoC

```solidity
function test_PoC_2_FeesManager_MemoryBug_Split() public {
    setUpPoC();
    _setupAndMintNFT(bidders[0]);
    uint256 nftId = bidderNFTIds[bidders[0]];

    uint256[] memory percentages = new uint256[](2);
    percentages[0] = 5000; 
    percentages[1] = 5000; 

    vm.startPrank(bidders[0]);
    // Proves: Memory not allocated -> Panic
    vm.expectRevert(); 
    vesting.splitTVS(PROJECT_ID, percentages, nftId);
    vm.stopPrank();
}
```

### Mitigation

Initialize the array before the loop in FeesManager.sol:
```solidity
newAmounts = new uint256[](length);
for (uint256 i; i < length;) { ... }
```
  