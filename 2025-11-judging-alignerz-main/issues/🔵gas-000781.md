# [000781] Unnecessary Storage Write During Array Removal
  
  ### Summary

An unnecessary storage write will cause gas inefficiency for the protocol as the `kolTVSIndexOf` mapping is assigned an invalid index value after the KOL address is removed from the `kolTVSAddresses` array.

### Root Cause

In `AlignerzVesting.sol:_claimRewardTVS()` the code assigns `rewardProject.kolTVSIndexOf[kol]` to `arrayLength - 1` immediately before calling `pop()`, which removes the last element. This assignment writes to storage even though the KOL's index mapping becomes irrelevant after removal, since the address is no longer in the array.


[unnecessary storage write](https://github.com/dualguard/2025-11-alignerz/blob/main/protocol/src/contracts/vesting/AlignerzVesting.sol#L617)

### Internal Pre-conditions

_No response_

### External Pre-conditions

_No response_

### Attack Path

It's not an attack, it's a gas optimization.

1. User calls `claimRewardTVS()` to claim TVS rewards
2. The function performs array removal using the swap-and-pop technique
3. Before the `pop()` operation, the code unnecessarily writes `arrayLength - 1` to `kolTVSIndexOf[kol]`
4. Immediately after, `pop()` removes the last element, making the written index invalid


### Impact

The protocol suffers unnecessary gas costs from an avoidable SSTORE operation (2,900 gas in most cases, or 20,000 gas if changing from zero to non-zero). This occurs every time a KOL claims TVS rewards.

### PoC

_No response_

### Mitigation

Remove the line `rewardProject.kolTVSIndexOf[kol] = arrayLength - 1;` entirely. Since the KOL address is being removed from the array, there is no need to update its index mapping. The mapping value will be ignored for this address going forward.
  