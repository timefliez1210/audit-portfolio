# [001027] Missing Access Control
  
  ### Summary

A missing access control modifier will cause a griefing vector for the owner and KOLs as any attacker will be able to force the distribution of rewards.

### Root Cause

In `AlignerzVesting.sol`, the functions `distributeRewardTVS` and `distributeStablecoinAllocation` are external but lack the `onlyOwner` modifier, contrary to the developer's intent.

### Internal Pre-conditions

The claim deadline has passed.

### External Pre-conditions

_No response_

### Attack Path

1. Protocol owner deploys the `AlignerzVesting` contract and launches a reward project by calling `launchRewardProject()` with a claim window of 30 days.
2. Owner allocates rewards to three KOLs by calling `setTVSAllocation()`, distributing 10,000 tokens each to Alice, Bob, and Charlie with their addresses stored in kolTVSAddresses.
3. During the 30-day claim window, Alice claims her reward by calling `claimRewardTVS()`, successfully receiving her TVS NFT and removing herself from the pending list.
4. Bob and Charlie do not claim during the window, leaving their addresses in kolTVSAddresses with 10,000 tokens each still allocated in the kolTVSRewards mapping.
5. The claim deadline passes on Day 31, making the `require(block.timestamp > rewardProject.claimDeadline)` check in the distribution functions evaluate to true.
6. Owner plans to coordinate the distribution of remaining rewards on Day 45 to align with a favorable market announcement and optimal tax timing for the KOLs.
7. On Day 32, an attacker who monitors the blockchain identifies the unclaimed rewards and calls `distributeRewardTVS(projectId, [Bob, Charlie])` as an external transaction.
8. The function executes successfully because there is no `onlyOwner` modifier, checking only that the deadline has passed, which it has.
9. The function calls _claimRewardTVS() for both Bob and Charlie, minting their TVS NFTs and transferring the vesting allocations to them immediately.
10. Bob and Charlie receive their rewards 13 days earlier than the owner intended, potentially during a tax year they wanted to avoid or before they were prepared to report the income.
11. Owner's carefully planned distribution timing is disrupted with no ability to prevent or reverse the premature distribution, and the attacker gains no financial benefit but successfully griefs the protocol's operational strategy.
12. The same attack vector exists for distributeStablecoinAllocation(), allowing attackers to force immediate stablecoin transfers to KOLs against the owner's distribution schedule.

### Impact

The protocol owner cannot control the timing of reward distributions after the claim deadline expires, losing the ability to coordinate distributions for tax optimization, market timing, or operational efficiency. KOL recipients may suffer unexpected tax liabilities if distributions occur in an unfavorable tax year or before they are prepared to report income. While no funds are stolen and rewards reach their intended recipients, the loss of administrative control over a 10,000 token distribution (potentially worth $100,000+ depending on token value) represents significant operational disruption. The griefing vector allows any observer to force distributions immediately after deadlines pass, eliminating the protocol's flexibility in managing reward timing and potentially causing compliance issues for recipients who require advance notice of token receipts.

### PoC

None

### Mitigation

Add the onlyOwner modifier to both distribution functions to restrict access to the protocol administrator and align with the documented intent and established design patterns:

  